(this["webpackJsonpmyLibrary"]=this["webpackJsonpmyLibrary"]||[]).push([["chunk-5aaacade"],{"1bf6":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"smart-lesson-container"},[e._m(0),n("div",{staticClass:"lesson-form"},[n("div",{staticClass:"form-group"},[n("label",{staticClass:"form-label"},[e._v("选择课程")]),n("el-select",{ref:"courseSelect",staticClass:"lesson-select",attrs:{placeholder:"请选择要生成教案的课程",filterable:"",clearable:""},model:{value:e.course,callback:function(t){e.course=t},expression:"course"}},e._l(e.courseList,(function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),n("div",{staticClass:"form-group"},[n("label",{staticClass:"form-label"},[e._v("知识点描述")]),n("el-input",{ref:"knowledgeInput",staticClass:"lesson-input",attrs:{type:"textarea",rows:6,maxlength:500,"show-word-limit":"",placeholder:"请详细描述要教学的知识点，例如：欧姆定律、电路分析方法、信号处理等"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey?e.handleSubmit(t):null}},model:{value:e.knowledge,callback:function(t){e.knowledge=t},expression:"knowledge"}}),e._m(1)],1),n("div",{staticClass:"form-actions"},[n("el-button",{staticClass:"lesson-btn",attrs:{type:"primary",loading:e.loading,disabled:!e.isFormValid,size:"large"},on:{click:e.handleSubmit}},[n("i",{staticClass:"el-icon-magic-stick"}),e._v(" "+e._s(e.loading?"正在生成教案...":"生成教案")+" ")]),n("el-button",{attrs:{disabled:e.loading,size:"large"},on:{click:e.resetForm}},[n("i",{staticClass:"el-icon-refresh"}),e._v(" 重置 ")])],1)]),e.answer?n("div",{staticClass:"lesson-answer"},[n("div",{staticClass:"answer-header"},[n("h3",[e._v("AI生成教案")]),n("el-button",{attrs:{type:"text",size:"small"},on:{click:e.copyAnswer}},[n("i",{staticClass:"el-icon-document-copy"}),e._v(" 复制内容 ")])],1),n("div",{staticClass:"answer-content",domProps:{innerHTML:e._s(e.renderMarkdown(e.answer))}})]):e._e()])},a=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"lesson-header"},[n("div",{staticClass:"header-content"},[n("h1",{staticClass:"title"},[e._v("智能教案生成")]),n("p",{staticClass:"subtitle"},[e._v("选择课程和知识点，AI将为您生成详细的教案内容")])])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"input-tips"},[n("i",{staticClass:"el-icon-info"}),e._v(" 提示：详细描述知识点有助于AI生成更准确的教案内容 ")])}],s=n("c14f"),o=n("1da1"),c=(n("99af"),n("ac1f"),n("5319"),n("498a"),n("af84")),i={name:"SmartLesson",data:function(){return{course:"",courseList:["电路分析基础","电子电路基础","信号与系统","电磁场微波技术","通信原理","数字信号处理","微电子技术"],knowledge:"",answer:"",loading:!1}},computed:{isFormValid:function(){return this.course.trim()&&this.knowledge.trim()&&!this.loading}},mounted:function(){var e=this;this.$nextTick((function(){e.focusCourseSelect()}))},methods:{focusCourseSelect:function(){this.$refs.courseSelect&&this.$refs.courseSelect.focus()},focusKnowledgeInput:function(){this.$refs.knowledgeInput&&this.$refs.knowledgeInput.focus()},handleSubmit:function(){var e=this;return Object(o["a"])(Object(s["a"])().m((function t(){var n,r,a;return Object(s["a"])().w((function(t){while(1)switch(t.n){case 0:if(e.isFormValid){t.n=3;break}if(e.course){t.n=1;break}return e.$message.warning("请选择课程"),e.focusCourseSelect(),t.a(2);case 1:if(e.knowledge){t.n=2;break}return e.$message.warning("请输入知识点描述"),e.focusKnowledgeInput(),t.a(2);case 2:return t.a(2);case 3:return e.loading=!0,e.answer="",n="请为课程【".concat(e.course,"】的知识点【").concat(e.knowledge,"】生成详细教案。要求：\n1. 教学目标明确\n2. 教学内容结构清晰\n3. 包含教学重点和难点\n4. 提供教学方法和步骤\n5. 包含课堂练习或作业建议\n请以专业的教案格式输出。"),t.p=4,t.n=5,Object(c["a"])(n,{onMessage:function(t){e.answer+=t},onDone:function(){e.loading=!1,e.$message.success("教案生成完成！")},onError:function(t){e.answer="AI服务异常: "+t.message,e.loading=!1,e.$message.error("生成失败，请重试")}});case 5:t.n=7;break;case 6:t.p=6,a=t.v,e.answer="AI服务异常: "+((null===(r=a.response)||void 0===r||null===(r=r.data)||void 0===r?void 0:r.message)||a.message),e.loading=!1,e.$message.error("生成失败，请重试");case 7:return t.a(2)}}),t,null,[[4,6]])})))()},resetForm:function(){var e=this;this.course="",this.knowledge="",this.answer="",this.$nextTick((function(){e.focusCourseSelect()}))},copyAnswer:function(){var e=this;this.answer&&navigator.clipboard.writeText(this.answer).then((function(){e.$message.success("内容已复制到剪贴板")})).catch((function(){e.$message.error("复制失败，请手动复制")}))},renderMarkdown:function(e){return e?e.replace(/\r\n|\n|\r/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/^### (.*$)/gim,"<h3>$1</h3>").replace(/^## (.*$)/gim,"<h2>$1</h2>").replace(/^# (.*$)/gim,"<h1>$1</h1>"):""}}},u=i,l=(n("cfe4"),n("2877")),d=Object(l["a"])(u,r,a,!1,null,"2523f431",null);t["default"]=d.exports},"635e":function(e,t,n){},af84:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return p})),n.d(t,"f",(function(){return h})),n.d(t,"d",(function(){return b}));var r=n("c14f"),a=n("b85c"),s=n("1da1");n("d9e2"),n("99af"),n("e9c4"),n("b64b"),n("d3b7"),n("2ca0"),n("498a");function o(e,t){return c.apply(this,arguments)}function c(){return c=Object(s["a"])(Object(r["a"])().m((function e(t,n){var s,o,c,i,u,l,d,p,f,h,w,b,m,v,g,k,y,_,O,j,S,C,T,x,$=arguments;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return s=n.onMessage,o=n.onDone,c=n.onError,i=$.length>2&&void 0!==$[2]?$[2]:"app-J4y46SO9GtwtjADyLAOj9tzL",u="http://101.43.162.190:8088/v1/chat-messages",l={inputs:{},query:t,response_mode:"streaming",user:"user"},d={Authorization:"Bearer ".concat(i),"Content-Type":"application/json"},e.p=1,e.n=2,fetch(u,{method:"POST",headers:d,body:JSON.stringify(l)});case 2:if(p=e.v,p.ok){e.n=3;break}throw new Error("HTTP error! status: ".concat(p.status));case 3:f=p.body.getReader(),h=new TextDecoder("utf-8"),w="";case 4:return e.n=5,f.read();case 5:if(b=e.v,m=b.done,v=b.value,!m){e.n=6;break}return console.log("Stream finished."),o&&o(),e.a(3,17);case 6:g=w+h.decode(v,{stream:!0}),k=g.split("\n"),w=k.pop()||"",y=Object(a["a"])(k),e.p=7,y.s();case 8:if((_=y.n()).done){e.n=13;break}if(O=_.value,O.startsWith("data:")){e.n=9;break}return e.a(3,12);case 9:if(e.p=9,j=O.substring(6),"[DONE]"!==j.trim()){e.n=10;break}return e.a(3,12);case 10:S=JSON.parse(j),"message"===S.event&&S.answer&&s&&s(S.answer),e.n=12;break;case 11:e.p=11,C=e.v,console.error("Failed to parse JSON from line:",O,C);case 12:e.n=8;break;case 13:e.n=15;break;case 14:e.p=14,T=e.v,y.e(T);case 15:return e.p=15,y.f(),e.f(15);case 16:e.n=4;break;case 17:e.n=19;break;case 18:e.p=18,x=e.v,console.error("Streaming failed:",x),c&&c(x);case 19:return e.a(2)}}),e,null,[[9,11],[7,14,15,16],[1,18]])}))),c.apply(this,arguments)}function i(e){return u.apply(this,arguments)}function u(){return u=Object(s["a"])(Object(r["a"])().m((function e(t){var n,a,s,o,c,i,u;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return n="http://101.43.162.190:8088/v1/workflows/run",a="app-n1JVzEVSjlnzr7PXVdzMYtdy",s={inputs:{chapter:t},response_mode:"blocking",user:"lesson-user"},o={Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},e.p=1,e.n=2,fetch(n,{method:"POST",headers:o,body:JSON.stringify(s)});case 2:if(c=e.v,c.ok){e.n=3;break}throw new Error("HTTP error! status: ".concat(c.status));case 3:return e.n=4,c.json();case 4:return i=e.v,e.a(2,i);case 5:throw e.p=5,u=e.v,u;case 6:return e.a(2)}}),e,null,[[1,5]])}))),u.apply(this,arguments)}function l(e){return d.apply(this,arguments)}function d(){return d=Object(s["a"])(Object(r["a"])().m((function e(t){var n,a,s,o,c,i,u,l=arguments;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:"app-bS8Qyzd7klGSkVvhbc2rlBs3",a="http://101.43.162.190:8088/v1/files/upload",s={Authorization:"Bearer ".concat(n)},o=new FormData,o.append("file",t),o.append("user","abc-123"),e.p=1,e.n=2,fetch(a,{method:"POST",headers:s,body:o});case 2:if(c=e.v,c.ok){e.n=3;break}throw new Error("HTTP error! status: ".concat(c.status));case 3:return e.n=4,c.json();case 4:return i=e.v,e.a(2,i.id);case 5:throw e.p=5,u=e.v,console.error("File upload failed:",u),u;case 6:return e.a(2)}}),e,null,[[1,5]])}))),d.apply(this,arguments)}function p(e){return f.apply(this,arguments)}function f(){return f=Object(s["a"])(Object(r["a"])().m((function e(t){var n,a,s,o,c,i,u,l,d,p=arguments;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return n=p.length>1&&void 0!==p[1]?p[1]:"circuit",a=p.length>2&&void 0!==p[2]?p[2]:"app-bS8Qyzd7klGSkVvhbc2rlBs3",s="http://101.43.162.190:8088/v1/workflows/run",o={inputs:{courseName:n,examFile:{type:"document",transfer_method:"local_file",upload_file_id:t}},response_mode:"blocking",user:"abc-124"},c={Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},e.p=1,e.n=2,fetch(s,{method:"POST",headers:c,body:JSON.stringify(o)});case 2:if(i=e.v,i.ok){e.n=3;break}throw new Error("HTTP error! status: ".concat(i.status));case 3:return e.n=4,i.json();case 4:return u=e.v,l="",u.data&&u.data.workflow_run_id&&u.data.workflow_run_id.outputs?l=u.data.workflow_run_id.outputs.text||"":u.data&&u.data.outputs?l=u.data.outputs.text||"":u.outputs&&(l=u.outputs.text||""),e.a(2,{success:!0,text:l,rawData:u});case 5:throw e.p=5,d=e.v,console.error("Exam analysis failed:",d),d;case 6:return e.a(2)}}),e,null,[[1,5]])}))),f.apply(this,arguments)}function h(e){return w.apply(this,arguments)}function w(){return w=Object(s["a"])(Object(r["a"])().m((function e(t){var n,a,s,o,c,i,u,l,d,p=arguments;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return n=p.length>1&&void 0!==p[1]?p[1]:"app-PMBbbHxJePSgvz2XPPytjEre",a="http://43.140.245.165:8993/v1/files/upload",s=new FormData,s.append("file",t),s.append("user","zxr"),e.p=1,e.n=2,fetch(a,{method:"POST",headers:{Authorization:"Bearer ".concat(n)},body:s});case 2:if(i=e.v,i.ok){e.n=3;break}throw new Error("HTTP error! status: ".concat(i.status));case 3:return e.n=4,i.json();case 4:if(u=e.v,console.log("Upload response:",u),l=u.id||u.file_id||(null===(o=u.data)||void 0===o?void 0:o.id)||(null===(c=u.data)||void 0===c?void 0:c.file_id)||"",l){e.n=5;break}throw console.error("Upload response data:",u),new Error("上传失败：未返回文件ID");case 5:return e.a(2,l);case 6:throw e.p=6,d=e.v,console.error("Resume file upload failed:",d),d;case 7:return e.a(2)}}),e,null,[[1,6]])}))),w.apply(this,arguments)}function b(e,t){return m.apply(this,arguments)}function m(){return m=Object(s["a"])(Object(r["a"])().m((function e(t,n){var a,s,o,c,i,u,l,d,p,f=arguments;return Object(r["a"])().w((function(e){while(1)switch(e.n){case 0:return a=f.length>2&&void 0!==f[2]?f[2]:"app-PMBbbHxJePSgvz2XPPytjEre",s="http://43.140.245.165:8993/v1/workflows/run",o={inputs:{resume_file:{transfer_method:"local_file",upload_file_id:t,type:"document"},job_description:n},response_mode:"blocking",user:"zxr"},c={Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},e.p=1,console.log("Optimize request payload:",JSON.stringify(o,null,2)),console.log("File ID:",t),e.n=2,fetch(s,{method:"POST",headers:c,body:JSON.stringify(o)});case 2:if(i=e.v,i.ok){e.n=4;break}return e.n=3,i.text();case 3:throw u=e.v,console.error("Optimize error response:",u),new Error("HTTP error! status: ".concat(i.status,", message: ").concat(u));case 4:return e.n=5,i.json();case 5:return l=e.v,d="",l.data&&l.data.workflow_run_id&&l.data.workflow_run_id.outputs?d=l.data.workflow_run_id.outputs.text||l.data.workflow_run_id.outputs.result||"":l.data&&l.data.outputs?d=l.data.outputs.text||l.data.outputs.result||"":l.outputs?d=l.outputs.text||l.outputs.result||"":l.result&&(d=l.result),e.a(2,{success:!0,text:d,rawData:l});case 6:throw e.p=6,p=e.v,console.error("Resume optimization failed:",p),p;case 7:return e.a(2)}}),e,null,[[1,6]])}))),m.apply(this,arguments)}},cfe4:function(e,t,n){"use strict";n("635e")}}]);