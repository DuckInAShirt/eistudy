(this["webpackJsonpmyLibrary"]=this["webpackJsonpmyLibrary"]||[]).push([["chunk-30e7710d"],{1388:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"lesson-plan-container"},[r("h2",[e._v("智能教案生成")]),r("el-form",{attrs:{inline:!0},nativeOn:{submit:function(e){e.preventDefault()}}},[r("el-form-item",{attrs:{label:"课程"}},[r("el-select",{staticStyle:{width:"180px"},model:{value:e.course,callback:function(t){e.course=t},expression:"course"}},[r("el-option",{attrs:{label:"电子电路基础",value:"ecircuit"}}),r("el-option",{attrs:{label:"电路分析基础",value:"circuit"}})],1)],1),r("el-form-item",{attrs:{label:"章节/知识点"}},[r("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"如：戴维南定理"},model:{value:e.chapter,callback:function(t){e.chapter=t},expression:"chapter"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.generateLessonPlan}},[e._v("生成教案")])],1)],1),e.result?r("el-card",{staticClass:"result-card",staticStyle:{"margin-top":"32px"}},[r("div",{staticClass:"result-header"},[r("h3",[e._v("AI生成教案")]),r("el-button",{attrs:{size:"small",type:"text",icon:"el-icon-document-copy"},on:{click:e.copyResult}},[e._v("复制")])],1),r("div",{staticClass:"markdown-content",domProps:{innerHTML:e._s(e.renderedResult)}})]):e._e()],1)},n=[],s=r("c14f"),o=r("1da1"),c=(r("e9c4"),r("af84")),u=r("7c5c"),i={name:"SmartLessonPlan",data:function(){return{course:"circuit",chapter:"",loading:!1,result:""}},computed:{renderedResult:function(){return this.result?u["marked"].parse(this.result,{gfm:!0,breaks:!0,headerIds:!1}):""}},methods:{generateLessonPlan:function(){var e=this;return Object(o["a"])(Object(s["a"])().m((function t(){var r,a,n;return Object(s["a"])().w((function(t){while(1)switch(t.n){case 0:if(e.chapter){t.n=1;break}return e.$message.warning("请输入章节/知识点"),t.a(2);case 1:return e.loading=!0,e.result="",t.p=2,t.n=3,Object(c["b"])(e.chapter);case 3:a=t.v,e.result=(null===(r=a.outputs)||void 0===r?void 0:r.lesson_plan)||JSON.stringify(a.outputs||a),t.n=5;break;case 4:t.p=4,n=t.v,e.result="生成失败: "+n.message;case 5:e.loading=!1;case 6:return t.a(2)}}),t,null,[[2,4]])})))()},copyResult:function(){var e=this;this.result&&navigator.clipboard.writeText(this.result).then((function(){e.$message.success("教案内容已复制到剪贴板")})).catch((function(){e.$message.error("复制失败，请手动复制")}))}}},l=i,p=(r("6665"),r("2877")),d=Object(p["a"])(l,a,n,!1,null,"6d23c005",null);t["default"]=d.exports},6665:function(e,t,r){"use strict";r("df3f")},af84:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return u})),r.d(t,"e",(function(){return l})),r.d(t,"c",(function(){return d})),r.d(t,"f",(function(){return h})),r.d(t,"d",(function(){return w}));var a=r("c14f"),n=r("b85c"),s=r("1da1");r("d9e2"),r("99af"),r("e9c4"),r("b64b"),r("d3b7"),r("2ca0"),r("498a");function o(e,t){return c.apply(this,arguments)}function c(){return c=Object(s["a"])(Object(a["a"])().m((function e(t,r){var s,o,c,u,i,l,p,d,f,h,b,w,v,m,y,k,g,O,j,_,S,P,T,x,z=arguments;return Object(a["a"])().w((function(e){while(1)switch(e.n){case 0:return s=r.onMessage,o=r.onDone,c=r.onError,u=z.length>2&&void 0!==z[2]?z[2]:"app-J4y46SO9GtwtjADyLAOj9tzL",i="http://101.43.162.190:8088/v1/chat-messages",l={inputs:{},query:t,response_mode:"streaming",user:"user"},p={Authorization:"Bearer ".concat(u),"Content-Type":"application/json"},e.p=1,e.n=2,fetch(i,{method:"POST",headers:p,body:JSON.stringify(l)});case 2:if(d=e.v,d.ok){e.n=3;break}throw new Error("HTTP error! status: ".concat(d.status));case 3:f=d.body.getReader(),h=new TextDecoder("utf-8"),b="";case 4:return e.n=5,f.read();case 5:if(w=e.v,v=w.done,m=w.value,!v){e.n=6;break}return console.log("Stream finished."),o&&o(),e.a(3,17);case 6:y=b+h.decode(m,{stream:!0}),k=y.split("\n"),b=k.pop()||"",g=Object(n["a"])(k),e.p=7,g.s();case 8:if((O=g.n()).done){e.n=13;break}if(j=O.value,j.startsWith("data:")){e.n=9;break}return e.a(3,12);case 9:if(e.p=9,_=j.substring(6),"[DONE]"!==_.trim()){e.n=10;break}return e.a(3,12);case 10:S=JSON.parse(_),"message"===S.event&&S.answer&&s&&s(S.answer),e.n=12;break;case 11:e.p=11,P=e.v,console.error("Failed to parse JSON from line:",j,P);case 12:e.n=8;break;case 13:e.n=15;break;case 14:e.p=14,T=e.v,g.e(T);case 15:return e.p=15,g.f(),e.f(15);case 16:e.n=4;break;case 17:e.n=19;break;case 18:e.p=18,x=e.v,console.error("Streaming failed:",x),c&&c(x);case 19:return e.a(2)}}),e,null,[[9,11],[7,14,15,16],[1,18]])}))),c.apply(this,arguments)}function u(e){return i.apply(this,arguments)}function i(){return i=Object(s["a"])(Object(a["a"])().m((function e(t){var r,n,s,o,c,u,i;return Object(a["a"])().w((function(e){while(1)switch(e.n){case 0:return r="http://101.43.162.190:8088/v1/workflows/run",n="app-n1JVzEVSjlnzr7PXVdzMYtdy",s={inputs:{chapter:t},response_mode:"blocking",user:"lesson-user"},o={Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},e.p=1,e.n=2,fetch(r,{method:"POST",headers:o,body:JSON.stringify(s)});case 2:if(c=e.v,c.ok){e.n=3;break}throw new Error("HTTP error! status: ".concat(c.status));case 3:return e.n=4,c.json();case 4:return u=e.v,e.a(2,u);case 5:throw e.p=5,i=e.v,i;case 6:return e.a(2)}}),e,null,[[1,5]])}))),i.apply(this,arguments)}function l(e){return p.apply(this,arguments)}function p(){return p=Object(s["a"])(Object(a["a"])().m((function e(t){var r,n,s,o,c,u,i,l=arguments;return Object(a["a"])().w((function(e){while(1)switch(e.n){case 0:return r=l.length>1&&void 0!==l[1]?l[1]:"app-bS8Qyzd7klGSkVvhbc2rlBs3",n="http://101.43.162.190:8088/v1/files/upload",s={Authorization:"Bearer ".concat(r)},o=new FormData,o.append("file",t),o.append("user","abc-123"),e.p=1,e.n=2,fetch(n,{method:"POST",headers:s,body:o});case 2:if(c=e.v,c.ok){e.n=3;break}throw new Error("HTTP error! status: ".concat(c.status));case 3:return e.n=4,c.json();case 4:return u=e.v,e.a(2,u.id);case 5:throw e.p=5,i=e.v,console.error("File upload failed:",i),i;case 6:return e.a(2)}}),e,null,[[1,5]])}))),p.apply(this,arguments)}function d(e){return f.apply(this,arguments)}function f(){return f=Object(s["a"])(Object(a["a"])().m((function e(t){var r,n,s,o,c,u,i,l,p,d=arguments;return Object(a["a"])().w((function(e){while(1)switch(e.n){case 0:return r=d.length>1&&void 0!==d[1]?d[1]:"circuit",n=d.length>2&&void 0!==d[2]?d[2]:"app-bS8Qyzd7klGSkVvhbc2rlBs3",s="http://101.43.162.190:8088/v1/workflows/run",o={inputs:{courseName:r,examFile:{type:"document",transfer_method:"local_file",upload_file_id:t}},response_mode:"blocking",user:"abc-124"},c={Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},e.p=1,e.n=2,fetch(s,{method:"POST",headers:c,body:JSON.stringify(o)});case 2:if(u=e.v,u.ok){e.n=3;break}throw new Error("HTTP error! status: ".concat(u.status));case 3:return e.n=4,u.json();case 4:return i=e.v,l="",i.data&&i.data.workflow_run_id&&i.data.workflow_run_id.outputs?l=i.data.workflow_run_id.outputs.text||"":i.data&&i.data.outputs?l=i.data.outputs.text||"":i.outputs&&(l=i.outputs.text||""),e.a(2,{success:!0,text:l,rawData:i});case 5:throw e.p=5,p=e.v,console.error("Exam analysis failed:",p),p;case 6:return e.a(2)}}),e,null,[[1,5]])}))),f.apply(this,arguments)}function h(e){return b.apply(this,arguments)}function b(){return b=Object(s["a"])(Object(a["a"])().m((function e(t){var r,n,s,o,c,u,i,l,p,d=arguments;return Object(a["a"])().w((function(e){while(1)switch(e.n){case 0:return r=d.length>1&&void 0!==d[1]?d[1]:"app-PMBbbHxJePSgvz2XPPytjEre",n="http://43.140.245.165:8993/v1/files/upload",s=new FormData,s.append("file",t),s.append("user","zxr"),e.p=1,e.n=2,fetch(n,{method:"POST",headers:{Authorization:"Bearer ".concat(r)},body:s});case 2:if(u=e.v,u.ok){e.n=3;break}throw new Error("HTTP error! status: ".concat(u.status));case 3:return e.n=4,u.json();case 4:if(i=e.v,console.log("Upload response:",i),l=i.id||i.file_id||(null===(o=i.data)||void 0===o?void 0:o.id)||(null===(c=i.data)||void 0===c?void 0:c.file_id)||"",l){e.n=5;break}throw console.error("Upload response data:",i),new Error("上传失败：未返回文件ID");case 5:return e.a(2,l);case 6:throw e.p=6,p=e.v,console.error("Resume file upload failed:",p),p;case 7:return e.a(2)}}),e,null,[[1,6]])}))),b.apply(this,arguments)}function w(e,t){return v.apply(this,arguments)}function v(){return v=Object(s["a"])(Object(a["a"])().m((function e(t,r){var n,s,o,c,u,i,l,p,d,f=arguments;return Object(a["a"])().w((function(e){while(1)switch(e.n){case 0:return n=f.length>2&&void 0!==f[2]?f[2]:"app-PMBbbHxJePSgvz2XPPytjEre",s="http://43.140.245.165:8993/v1/workflows/run",o={inputs:{resume_file:{transfer_method:"local_file",upload_file_id:t,type:"document"},job_description:r},response_mode:"blocking",user:"zxr"},c={Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},e.p=1,console.log("Optimize request payload:",JSON.stringify(o,null,2)),console.log("File ID:",t),e.n=2,fetch(s,{method:"POST",headers:c,body:JSON.stringify(o)});case 2:if(u=e.v,u.ok){e.n=4;break}return e.n=3,u.text();case 3:throw i=e.v,console.error("Optimize error response:",i),new Error("HTTP error! status: ".concat(u.status,", message: ").concat(i));case 4:return e.n=5,u.json();case 5:return l=e.v,p="",l.data&&l.data.workflow_run_id&&l.data.workflow_run_id.outputs?p=l.data.workflow_run_id.outputs.text||l.data.workflow_run_id.outputs.result||"":l.data&&l.data.outputs?p=l.data.outputs.text||l.data.outputs.result||"":l.outputs?p=l.outputs.text||l.outputs.result||"":l.result&&(p=l.result),e.a(2,{success:!0,text:p,rawData:l});case 6:throw e.p=6,d=e.v,console.error("Resume optimization failed:",d),d;case 7:return e.a(2)}}),e,null,[[1,6]])}))),v.apply(this,arguments)}},df3f:function(e,t,r){}}]);